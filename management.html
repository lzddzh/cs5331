<!DOCTYPE html>
<html lang="en">
  <head> <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Prestashop Adertisement System</title>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
      <!--script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script-->
      <!--script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script-->
<!-- Latest compiled and minified CSS -->
<!--link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"-->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" type="text/css" media="screen" />

<link rel="stylesheet/less" href="https://jdewit.github.io/bootstrap-timepicker/css/timepicker.less">

  </head>
  <body>
<div id="displayInfo" style="visibility:hidden;">Please login.</div>
<div id="manageBox" style="visibility:hidden;">
<nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Prestashop Advertisement System</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li class="active"><a href="#">Publish</a></li>
            <li><a href="/prestashop/addAdv/statistics.html">Statistics</a></li>
            <li><a id ='welcomeID'>Hello! </a></li>
            <li><a id ='logOut'> LogOut </a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>
<div class="row" style="margin-top:70px; margin-left:100px;">
<div class="col-lg-7 col-md-7 col-sm-7">
<div id ="publishPanel" class="panel panel-primary" >
<div class="panel-heading">
<h3 class="panel-title">Publish Adv</h3></div>
<div class="panel-body" >
<label for="basic-url"> Advertisement Slogan</label>
<div class="input-group">
<span class="input-group-addon" id="basic-addon1">Slogan</span>
  <input id="inputSlogan" type="text" class="form-control" placeholder="Say something ..." aria-describedby="basic-addon1">
</div>

<label for="basic-url"> Your Name </label>
<div class="input-group">
<span class="input-group-addon" id="basic-addon1">name</span>
  <input id="inputName" type="text" class="form-control" placeholder="Your name will show on the ad." aria-describedby="basic-addon1">
</div>

<label for="basic-url"> Your Address </label>
<div class="input-group">
<span class="input-group-addon" id="basic-addon1">address</span>
  <input id="inputAddress" type="text" class="form-control" placeholder="Your address will show on the ad." aria-describedby="basic-addon1">
</div>

<label for="basic-url">Background Picture URL</label>
<div class="input-group">
  <span class="input-group-addon" id="basic-addon3">https://</span>
  <input id="inputImagAddr" type="text" class="form-control" id="basic-url" placeholder="some/somepicture.jpg" aria-describedby="basic-addon3">
</div>

<label for="basic-url">Click on Your AD and link to URL</label>
<div class="input-group">
  <span class="input-group-addon" id="basic-addon3">https://</span>
  <input id="inputLinkAddr" type="text" class="form-control" id="basic-url" placeholder="some/somecategory" aria-describedby="basic-addon3">
</div>


<label for="basic-url">Your budget</label>
<div class="input-group">
  <span class="input-group-addon">$</span>
  <input id="inputBudget" type="text" class="form-control" aria-label="Amount (to the nearest dollar)">
  <span class="input-group-addon">.00</span>
</div>

<label for="basic-url">Show your AD at:</label>
<br />
<div class="btn-group" data-toggle="buttons">
  <label class="btn btn-default active">
    <input id="inputCate1" type="checkbox" autocomplete="off" checked> Main Page 
  </label>
  <label class="btn btn-default">
    <input id="inputCate2" type="checkbox" autocomplete="off"> Item Info Page 
  </label>
  <label class="btn btn-default">
    <input id="inputCate3" type="checkbox" autocomplete="off"> Personal Info Page
  </label>
</div>
<br />
<label for="basic-url">Show your Ad to:</label>
<br />
<div class="btn-group" data-toggle="buttons">
  <label class="btn btn-default active">
    <input id="inputUsr1" type="checkbox" autocomplete="off" checked> Unlogin Users 
  </label>
  <label class="btn btn-default">
    <input id="inputUsr2" type="checkbox" autocomplete="off"> Login Users 
  </label>
</div>

<br />
<label for="basic-url">Choose the time you want show your Ad:</label>
<div style="width:300px;" class="input-group bootstrap-timepicker timepicker">
            <span class="input-group-addon">Start Time</span>
            <input id="timepicker1" type="text" class="form-control input-small">
            <span class="input-group-addon"><i class="glyphicon glyphicon-time"></i></span>
</div>

<div style="margin-top:10px; width:300px;" class="input-group bootstrap-timepicker timepicker">
            <span class="input-group-addon">End   Time</span>
            <input id="timepicker2" type="text" class="form-control input-small">
            <span class="input-group-addon"><i class="glyphicon glyphicon-time"></i></span>
</div>

 

</div>
</div>
</div>
<div class="col-lg-3 col-md-3 col-sm-3">
<div id="previewPanel" class="panel panel-success" >
  <div class="panel-heading">
    <h3 class="panel-title">Adv Preview</h3>
  </div>
  <div id="previewPanelBody" class="panel-body" >
  <div style="position: relavent; left:200px;"> <h4>Your adv will be previewed at here.</h4> </div>
  </div>
</div>
</div>
</div>
        <button id="submit" style="width:300px; margin:20px 20px 100px 300px;" class="btn btn-lg btn-primary btn-block" type="button">Add Advertisement</button>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <!-- script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script-->
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>

<!-- Optional theme -->
<!--link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous"-->

<!-- Latest compiled and minified JavaScript -->
<!-- script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script-->

<script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

<script src="//cdnjs.cloudflare.com/ajax/libs/less.js/2.5.1/less.min.js"></script>
<script src="https://jdewit.github.io/bootstrap-timepicker/js/bootstrap-timepicker.js"></script>

</div>
  </body>

<script>

function setCookie(key, value) {
    var expires = new Date();
    expires.setTime(expires.getTime() + (1 * 24 * 60 * 60 * 1000));
    document.cookie = key + '=' + value + ';expires=' + expires.toUTCString();
}

function getCookie(key) {
    var keyValue = document.cookie.match('(^|;) ?' + key + '=([^;]*)(;|$)');
    return keyValue ? keyValue[2] : null;
}

$(document).ready(function(){
  if (getCookie('loginUsr').indexOf('@') > -1) {
    document.getElementById("manageBox").style.visibility="visible";
    document.getElementById("welcomeID").innerHTML="Hello!" + getCookie('loginUsr');
  } else {
    document.getElementById("manageBox").style.visibility="hidden";
    document.getElementById("displayInfo").style.visibility="visible";
  }
  $("#logOut").click(function(){
    setCookie('loginUsr', null);
    document.location="/prestashop/addAdv/index.html";
  });

  $('#timepicker1').timepicker({showMeridian: false});
  $('#timepicker2').timepicker({showMeridian: false});
  document.getElementById('timepicker1').value="00:00";
  document.getElementById('timepicker2').value="23:59";
});

$(document).ready(function(){

var name = $("#inputName").val();
var slogan = $("#inputSlogan").val();
var address = $("#inputAddress").val(); 
var backgroundURL = $("#inputImagAddr").val();
var linkURL = $("#inputLinkAddr").val(); 

  //document.getElementById('previewPanelBody').innerHTML = '<div id="adleft" onclick=\"window.open(\''+linkURL+'\')\"; style="width:70px; height:100px; padding:20px; overflow: auto; text-overflow: ellipsis; font:15px/20px arial; background-color:#06c; background-image:url(' + backgroundURL + '); background-size: 100% auto; position:relavent; cursor:pointer; color:#000; left:0;"><div style="text-align:center;"><h4>'+slogan+'</h4></div><div style="position:absolute; bottom:0px;"><p style="font:10px/20px arial;">'+name+'<br />'+address+'</p></div></div>';
$(':input').each(function() {
   var elem = $(this);

   // Save current value of element
   elem.data('oldVal', elem.val());

   // Look for changes in the value
   elem.bind("propertychange change click keyup input paste", function(event){
      // If value has changed...
      if (elem.data('oldVal') != elem.val()) {
       // Updated stored value
       elem.data('oldVal', elem.val());

       // Do action
       //alert('changed');
       name = $("#inputName").val();
       slogan = $("#inputSlogan").val();
       address = $("#inputAddress").val(); 
       backgroundURL = $("#inputImagAddr").val();
       linkURL = $("#inputLinkAddr").val(); 

  if (backgroundURL.indexOf('https:') <= -1) backgroundURL = "https://" + backgroundURL;
  if (linkURL.indexOf('https:') <= -1) linkURL = "https://" + linkURL;

  document.getElementById('previewPanelBody').innerHTML = '<div id="adleft" onclick=\"window.open(\''+linkURL+'\')\"; style="width:70px; height:100px; padding:5px; overflow: auto; text-overflow: ellipsis; arial; background-color:#06c; background-image:url(' + backgroundURL + '); background-size: 100% auto; position:relative; cursor:pointer; color:#000; left:0;"><div style="text-align:center;"><p style="font:10px/20px arial;">'+slogan+'</p></div><div style="position:absolute; bottom:10px;"><p style="font:6px/20px arial;">'+name+'<br />'+address+'</p></div></div>';
     }
   });
 });
});

//POST the add item to back-end 
$(document).ready(function(){
$("#submit").click(function(){
var name = $("#inputName").val();
var slogan = $("#inputSlogan").val();
var email = getCookie('loginUsr');
var address = $("#inputAddress").val(); 
var imgAddr = $("#inputImagAddr").val();
var linkAddr = $("#inputLinkAddr").val(); 
var budget = $("#inputBudget").val();
var showAdWhere = (document.getElementById("inputCate1").checked ? "home":" ") + "+" + (document.getElementById("inputCate2").checked ? "itemInfo":" ") + "+" + (document.getElementById("inputCate3").checked ? "usrInfo":" ");
var showAdWho = (document.getElementById("inputUsr1").checked ? "loginFalse":" ") + "+" + (document.getElementById("inputUsr2").checked ? "loginTrue":" ");
var starttime =  $("#timepicker1").val();
var endtime = $("#timepicker2").val();
if (starttime.length == 4) starttime = '0'+starttime;
if (endtime.length == 4) endtime = '0'+endtime;
var showAdWhen =  starttime + '-' + endtime; 
// Checking for blank fields.
if( slogan == '' || name =='' || email=='' || address=='' || imgAddr=='' || 
linkAddr=='' || budget=='' || $("#timepicker1").val()=='' || $("#timepicker2").val()==''){
alert("Please fill all fields...!!!!!!");
}else {
$.post("/prestashop/addAdv/addAdv.php",{ 
slogan1: slogan,
name1: name, 
email1:email,
address1:address,
imgAddr1:imgAddr,
linkAddr1:linkAddr,
budget1:budget,
showAdWhere1:showAdWhere,
showAdWho1:showAdWho,
showAdWhen1:showAdWhen},function(data) {
if(data=='New record created successfully'){
alert('Your adv published successfully!');
} else{
alert(data);
}
});
}
});
});



</script>


</html>
